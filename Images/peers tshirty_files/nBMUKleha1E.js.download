;/*FB_PKG_DELIM*/

__d("useMAWCreateOptimisticReactionInIDB",["MAWAckLevel","MAWDbMsg","MAWDbReaction","MAWDbReactionsTxns","MAWDexieTable","MAWSendReactionMsg","MAWTransactionMode","MAWTransactor","WAJids","WATimeUtils","react","toMsgrUserJid"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useCallback;function a(){return i}function i(a,b,e,f,g,h){g=d("MAWSendReactionMsg").sanitizeReaction(g);h=c("toMsgrUserJid")(h);return j(a,f,g,h,b.externalId,e)}var j=d("MAWTransactor").makeMsgrUIWritableTransactor({messages:d("MAWTransactionMode").READONLY,reactions:d("MAWTransactionMode").READWRITE,threads:d("MAWTransactionMode").READONLY},"writeOptimisticReactionToDb",function(a){return function(b,c,e,f,g,h){return a.threads.get({jid:b}).then(function(b){return b==null?d("MAWDexieTable").dexieResolve():d("MAWDexieTable").dexieAll([a.reactions.where("reactToExternalId").equals(g).toArray(),d("MAWDbReactionsTxns").getNextReactionIdNumberForThread(a,b)]).then(function(i){var j=i[0];i=i[1];var k=d("MAWDbReaction").findMatchingReaction(j,b.jid,d("WAJids").AUTHOR_ME);j=d("MAWSendReactionMsg").calculateSenderTimestampMs(j);i=d("MAWDbReaction").formatReactionForDb(b.jid,c,d("MAWDbMsg").craftReactionId(b.chatId,i),g,e,e,f,h,d("WATimeUtils").unixTime(),d("WAJids").AUTHOR_ME,k==null?void 0:k.rowId,d("MAWAckLevel").ACK.partialOptimistic,j);return d("MAWDbReactionsTxns").putReaction(a,i).then(function(a){return{optimisticRowId:a,originalReactionState:k}})})})}});g["default"]=a}),98);
__d("useMAWMarkOptimisticReactionAsFailedInIDB",["MAWAckLevel","MAWTransactionMode","MAWTransactor","Promise","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i;(i||d("react")).useCallback;function a(){return j}function j(a){return(a==null?void 0:a.optimisticRowId)!=null?k(a==null?void 0:a.optimisticRowId,a.originalReactionState):(h||(h=b("Promise"))).resolve()}var k=d("MAWTransactor").makeMsgrUIWritableTransactor({reactions:d("MAWTransactionMode").READWRITE},"markOptimisticReactionAsFailedInDb",function(a){return function(b,c){return a.reactions.get(b).then(function(e){(e==null?void 0:e.ack)===d("MAWAckLevel").ACK.partialOptimistic&&(c==null?a.reactions["delete"](b):a.reactions.put(babelHelpers["extends"]({},c,{rowId:b})))})}});g["default"]=a}),98);