;/*FB_PKG_DELIM*/

__d("MAWDatabaseInteractionTracing",["interaction-tracing"],(function(a,b,c,d,e,f,g){"use strict";function a(a){c("interaction-tracing").InteractionTracingCore.getPendingInteractions().forEach(function(b){b.addSubspan("MAWLiveQuery_"+a.callsite,"AppTiming",a.startSinceEpoch,a.endSinceEpoch,{full_duration:(a.endSinceEpoch-a.startSinceEpoch)/1e3})})}g.recordLiveQuery=a}),98);
__d("MAWEditMsgHistoryUIConverter",["MAWBridgeEditMsgHistoryAddedHandler","MAWDbEditMsgHistory"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return babelHelpers["extends"]({},a,{editMsgHistoryId:d("MAWDbEditMsgHistory").convertToEditMsgHistoryId64(a.editMsgHistoryId),originalMsgId:b})}function i(a,b){return d("MAWBridgeEditMsgHistoryAddedHandler").composeEditHistoryMsg(a,b)}function a(a,b,c){a=h(a,b);return i(a,c)}g.mawToLS=a}),98);
__d("MAWFanOutObservable",["relay-runtime/network/RelayObservable","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={state:"empty"},d=null,e=new Set(),f=function(a){switch(b.state){case"val":a.next(b.value);break;case"err":a.error(b.value);break;case"complete":a.complete()}},g=function(){e.forEach(function(a){return f(a)})};return c("relay-runtime/network/RelayObservable").create(function(h){e.add(h);d||(d=a.subscribe({complete:function(){b={state:"complete"},g()},error:function(a){b={state:"err",value:a},g()},next:function(a){b={state:"val",value:a},g()}}));f(h);return function(){e["delete"](h),c("setTimeout")(function(){if(e.size===0){var a;(a=d)==null?void 0:a.unsubscribe();d=null}},0)}})}g.buildFanoutObservable=a}),98);
__d("MAWLiveQuery",["FBLogger","MAWDatabaseInteractionTracing","MAWDexie","MAWFanOutObservable","Promise","cr:11978","cr:1265","performanceNow","relay-runtime/network/RelayObservable"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("relay-runtime/network/RelayObservable").create(function(a){});function k(a){return d("MAWDexie").liveQuery(a)}function l(){var a;return d("MAWDexie").Promise==null?void 0:(a=d("MAWDexie").Promise.PSD)==null?void 0:a.subscr}function m(a,d){return function(){d.start=Date.now();d.startSinceEpoch=(i||(i=c("performanceNow")))();return a().then(function(a){d.queryEnd=Date.now();if(b("cr:1265")!=null){var c;d.keyRanges=(c=b("cr:11978")==null?void 0:b("cr:11978").getObservabilitySets(l()))!=null?c:{};d.result=o(a)}return a})}}var n=3;function o(a){return Array.isArray(a)&&a.length>n?[].concat(a.slice(0,n-1),["<truncated...>",a[a.length-1]]):a}function a(a,b){return(typeof a==="function"?a():a)?b():j}function e(a,b,c){var e=p(a,b,c,arguments[3]);return d("MAWFanOutObservable").buildFanoutObservable(e)}function p(a,e,f,g){if(!a)return j;var l=(g=g)!=null?g:"<unknown>",n={callsite:l,end:0,endSinceEpoch:0,keyRanges:{},queryEnd:0,result:void 0,start:0,startSinceEpoch:0,transformedResult:void 0};g=m(function(){return e(a)},n);var p=k(g);return c("relay-runtime/network/RelayObservable").create(function(a){var e=p.subscribe({complete:a.complete,error:a.error,next:function(e){(h||(h=b("Promise"))).resolve(f(e)).then(function(e){n.end=Date.now(),n.endSinceEpoch=(i||(i=c("performanceNow")))(),b("cr:1265")!=null&&(n.transformedResult=o(e),b("cr:1265").recordLiveQuery(n)),d("MAWDatabaseInteractionTracing").recordLiveQuery(n),a.next(e)})["catch"](function(b){c("FBLogger")("messenger_e2ee_web").catching(b).mustfix("Dexie liveQuery value transformer failure in %s",l),a.error(b)})}});return function(){return e.unsubscribe()}})}function f(a){return a===j}g.emptyRelayObservable=j;g.liveQuery=k;g.maybeCreate=a;g.createMawObservable=e;g.createRawMAWObservable_DO_NOT_USE=p;g.isMAWLiveQueryEmptyRelayObservable=f}),98);
__d("useMawDbInUI",["LSSuspense","MAWIndexedDbUI","MAWStateContext.react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||(h=c("LSSuspense"))).makeCollection();function a(){var a=d("react-compiler-runtime").c(1),b=d("MAWStateContext.react").useMAWSelector(k);if(b){a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=(h||(h=c("LSSuspense"))).getFromCollection(i,d("MAWIndexedDbUI").MawDbInUISingleton,j),a[0]=b):b=a[0];return b}}function j(){return d("MAWIndexedDbUI").MawDbInUISingleton}function k(a){return a.isMAWDBinUILoaded}g["default"]=a}),98);
__d("useEditMessageHistoryMAW",["MAWChatJid","MAWDbMsg","MAWEditMsgHistoryUIConverter","MAWLiveQuery","asyncToGeneratorRuntime","nullthrows","react","react-compiler-runtime","useAsyncReStore","useMawDbInUI","useObservable"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(a,e){var f=d("react-compiler-runtime").c(9),g=c("useMawDbInUI")(),h=c("useAsyncReStore")(),j;f[0]!==h||f[1]!==g||f[2]!==a?(j=function(){return d("MAWLiveQuery").createMawObservable(g,function(b){return b.openReadonlyTransaction(["messages","editMsgHistory"],function(b){return b.messages.where("msgId").equals(c("nullthrows")(d("MAWDbMsg").toMsgId(a))).first().then(function(a){if(a==null||a.editCount===0)return;return b.editMsgHistory.where(["originalMsgExternalId","threadJid"]).equals([a.externalId,a.threadJid]).toArray().then(function(b){b=b.sort(i).slice(0,-1);return{editMsgHistory:b,threadJid:a.threadJid}})})})},function(){var e=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(b==null)return;var e=(yield h),f=(yield d("MAWChatJid").toThreadKey(e.tables,b.threadJid,"useEditMessageHistoryMAW"));return b.editMsgHistory.map(function(b){return d("MAWEditMsgHistoryUIConverter").mawToLS(b,c("nullthrows")(d("MAWDbMsg").toMsgId(a)),f)})});return function(a){return e.apply(this,arguments)}}())},f[0]=h,f[1]=g,f[2]=a,f[3]=j):j=f[3];var k;f[4]!==e||f[5]!==j?(k=d("MAWLiveQuery").maybeCreate(e,j),f[4]=e,f[5]=j,f[6]=k):k=f[6];e=k;j=e;k=c("useObservable")(j);e=k[0];if(f[7]!==e){k=(j=e)!=null?j:[];f[7]=e;f[8]=k}else k=f[8];return k}function i(a,b){return a.editTs-b.editTs}g["default"]=a}),98);
__d("useSelectedReactionMAW",["FBLogger","MAWDbMsg","MAWLiveQuery","WAJids","react","react-compiler-runtime","relay-runtime/network/RelayObservable","useMawDbInUI","useObservable"],(function(a,b,c,d,e,f,g){"use strict";var h;(h||d("react")).useMemo;function a(a,b){var e=d("react-compiler-runtime").c(6),g=c("useMawDbInUI")(),h;bb0:{if(e[0]!==b||e[1]!==g||e[2]!==a){var k=a!=null?d("MAWDbMsg").toMsgId(a):null;if(k==null){b&&c("FBLogger")("messenger_e2ee_web").warn("[useSelectedReactionMAW] unexpected messageId format");var l;e[5]===Symbol["for"]("react.memo_cache_sentinel")?(l=c("relay-runtime/network/RelayObservable").from(),e[5]=l):l=e[5];h=l;break bb0}l=d("MAWLiveQuery").maybeCreate(b,function(){return d("MAWLiveQuery").createMawObservable(g,function(a){return a.openReadonlyTransaction(["reactions"],function(a){return a.reactions.where("reactToMsgId").equals(k).filter(j).first()})},i,f.id+":47")});e[0]=b;e[1]=g;e[2]=a;e[3]=l;e[4]=h}else l=e[3],h=e[4];h=l}b=h;a=c("useObservable")(b);e=a[0];if(e!=null)return e}function i(a){return a==null?void 0:a.reaction}function j(a){return a.author===d("WAJids").AUTHOR_ME}g["default"]=a}),98);